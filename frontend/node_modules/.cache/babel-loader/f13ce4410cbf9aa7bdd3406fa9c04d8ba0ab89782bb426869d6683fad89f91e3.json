{"ast":null,"code":"var _jsxFileName = \"D:\\\\Ecommerce\\\\frontend\\\\src\\\\components\\\\Cart\\\\Cart.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { useAppContext } from '../../context/AppContext';\nimport { Link, useNavigate } from 'react-router-dom';\nimport './cart.css';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const Cart = () => {\n  _s();\n  const [cartItems, setCartItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const {\n    user\n  } = useAppContext(); // Lấy thông tin người dùng từ context\n  const navigate = useNavigate();\n  useEffect(() => {\n    if (!user) {\n      navigate('/login'); // Chuyển hướng đến trang đăng nhập nếu chưa đăng nhập\n      return;\n    }\n\n    // Lấy giỏ hàng từ API\n    axios.get(`http://localhost:3003/api/cart/user/${user.id}`).then(res => {\n      setCartItems(res.data || []);\n    }).catch(err => {\n      console.error('Lỗi lấy giỏ hàng:', err);\n    }).finally(() => {\n      setLoading(false);\n    });\n  }, [user, navigate]);\n\n  // Tính tổng tiền giỏ hàng\n  const totalAmount = cartItems.reduce((total, item) => total + item.quantity * item.productId.price, 0);\n\n  // Xử lý thay đổi số lượng sản phẩm\n  const handleQuantityChange = (itemId, action) => {\n    setCartItems(prevItems => {\n      return prevItems.map(item => {\n        if (item._id === itemId) {\n          const newQuantity = action === 'increase' ? item.quantity + 1 : item.quantity - 1;\n          // Update backend\n          axios.patch(`http://localhost:3003/api/cart/update/${itemId}`, {\n            quantity: newQuantity\n          }).then(response => {\n            console.log('Cập nhật giỏ hàng thành công:', response.data);\n          }).catch(error => {\n            console.error('Lỗi cập nhật giỏ hàng:', error);\n          });\n          return {\n            ...item,\n            quantity: newQuantity\n          };\n        }\n        return item;\n      });\n    });\n  };\n  const handleRemoveItem = itemId => {\n    axios.delete(`http://localhost:3003/api/cart/remove/${itemId}`).then(response => {\n      console.log('Đã xóa sản phẩm khỏi giỏ hàng');\n      setCartItems(cartItems.filter(item => item._id !== itemId)); // Cập nhật giỏ hàng sau khi xóa\n    }).catch(err => {\n      console.error('Lỗi xóa sản phẩm:', err);\n    });\n  };\n  if (loading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"\\u0110ang t\\u1EA3i...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 67,\n    columnNumber: 23\n  }, this);\n  if (cartItems.length === 0) return /*#__PURE__*/_jsxDEV(\"p\", {\n    children: \"Gi\\u1ECF h\\xE0ng c\\u1EE7a b\\u1EA1n hi\\u1EC7n t\\u1EA1i kh\\xF4ng c\\xF3 s\\u1EA3n ph\\u1EA9m.\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 38\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"cart\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Gi\\u1ECF h\\xE0ng c\\u1EE7a b\\u1EA1n\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cart-items\",\n      children: cartItems.map(item => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cart-item\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cart-item-info\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: item.productId.image[0],\n            alt: item.productId.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(Link, {\n              to: `/product/${item.productId._id}`,\n              children: item.productId.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 79,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Gi\\xE1: \\u0111\", item.productId.price]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 80,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"cart-item-actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"quantity-control\",\n            children: [/*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleQuantityChange(item._id, 'decrease'),\n              children: \"-\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              value: item.quantity,\n              min: \"1\",\n              readOnly: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 86,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleQuantityChange(item._id, 'increase'),\n              children: \"+\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 87,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"remove-item\",\n            onClick: () => handleRemoveItem(item._id),\n            children: \"X\\xF3a\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 13\n        }, this)]\n      }, item._id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cart-summary\",\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"T\\u1ED5ng ti\\u1EC1n: \\u0111\", totalAmount]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/checkout\",\n        className: \"checkout-button\",\n        children: \"Thanh to\\xE1n\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 5\n  }, this);\n};\n_s(Cart, \"hXMB4SmGYF+FjRqBvcYSZQF7D10=\", false, function () {\n  return [useAppContext, useNavigate];\n});\n_c = Cart;\nvar _c;\n$RefreshReg$(_c, \"Cart\");","map":{"version":3,"names":["React","useState","useEffect","useAppContext","Link","useNavigate","axios","Cart","cartItems","setCartItems","loading","setLoading","user","navigate","get","id","then","res","data","catch","err","console","error","finally","totalAmount","reduce","total","item","quantity","productId","price","handleQuantityChange","itemId","action","prevItems","map","_id","newQuantity","patch","response","log","handleRemoveItem","delete","filter","length","image","name"],"sources":["D:/Ecommerce/frontend/src/components/Cart/Cart.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useAppContext } from '../../context/AppContext';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport './cart.css';\r\nimport axios from 'axios';\r\n\r\nexport const Cart = () => {\r\n  const [cartItems, setCartItems] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const { user } = useAppContext(); // Lấy thông tin người dùng từ context\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      navigate('/login'); // Chuyển hướng đến trang đăng nhập nếu chưa đăng nhập\r\n      return;\r\n    }\r\n\r\n    // Lấy giỏ hàng từ API\r\n    axios.get(`http://localhost:3003/api/cart/user/${user.id}`)\r\n      .then((res) => {\r\n        setCartItems(res.data || []);\r\n      })\r\n      .catch((err) => {\r\n        console.error('Lỗi lấy giỏ hàng:', err);\r\n      })\r\n      .finally(() => {\r\n        setLoading(false);\r\n      });\r\n  }, [user, navigate]);\r\n\r\n  // Tính tổng tiền giỏ hàng\r\n  const totalAmount = cartItems.reduce((total, item) => total + (item.quantity * item.productId.price), 0);\r\n\r\n  // Xử lý thay đổi số lượng sản phẩm\r\n  const handleQuantityChange = (itemId, action) => {\r\n    setCartItems((prevItems) => {\r\n      return prevItems.map(item => {\r\n        if (item._id === itemId) {\r\n          const newQuantity = action === 'increase' ? item.quantity + 1 : item.quantity - 1;\r\n          // Update backend\r\n          axios.patch(`http://localhost:3003/api/cart/update/${itemId}`, { quantity: newQuantity })\r\n            .then((response) => {\r\n              console.log('Cập nhật giỏ hàng thành công:', response.data);\r\n            })\r\n            .catch((error) => {\r\n              console.error('Lỗi cập nhật giỏ hàng:', error);\r\n            });\r\n          return { ...item, quantity: newQuantity };\r\n        }\r\n        return item;\r\n      });\r\n    });\r\n  };\r\n\r\n  const handleRemoveItem = (itemId) => {\r\n    axios.delete(`http://localhost:3003/api/cart/remove/${itemId}`)\r\n      .then((response) => {\r\n        console.log('Đã xóa sản phẩm khỏi giỏ hàng');\r\n        setCartItems(cartItems.filter(item => item._id !== itemId)); // Cập nhật giỏ hàng sau khi xóa\r\n      })\r\n      .catch((err) => {\r\n        console.error('Lỗi xóa sản phẩm:', err);\r\n      });\r\n  };\r\n\r\n  if (loading) return <p>Đang tải...</p>;\r\n  if (cartItems.length === 0) return <p>Giỏ hàng của bạn hiện tại không có sản phẩm.</p>;\r\n\r\n  return (\r\n    <div className=\"cart\">\r\n      <h2>Giỏ hàng của bạn</h2>\r\n      <div className=\"cart-items\">\r\n        {cartItems.map((item) => (\r\n          <div key={item._id} className=\"cart-item\">\r\n            <div className=\"cart-item-info\">\r\n              <img src={item.productId.image[0]} alt={item.productId.name} />\r\n              <div>\r\n                <Link to={`/product/${item.productId._id}`}>{item.productId.name}</Link>\r\n                <p>Giá: đ{item.productId.price}</p>\r\n              </div>\r\n            </div>\r\n            <div className=\"cart-item-actions\">\r\n              <div className=\"quantity-control\">\r\n                <button onClick={() => handleQuantityChange(item._id, 'decrease')}>-</button>\r\n                <input type=\"number\" value={item.quantity} min=\"1\" readOnly />\r\n                <button onClick={() => handleQuantityChange(item._id, 'increase')}>+</button>\r\n              </div>\r\n              <button className=\"remove-item\" onClick={() => handleRemoveItem(item._id)}>Xóa</button>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      <div className=\"cart-summary\">\r\n        <p>Tổng tiền: đ{totalAmount}</p>\r\n        <Link to=\"/checkout\" className=\"checkout-button\">Thanh toán</Link>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}